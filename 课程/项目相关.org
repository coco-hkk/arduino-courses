:PROPERTIES:
:ID:       5453ea1e-be7e-4b9c-b365-81d0ed507b89
:mtime:    20220708095618 20220630085830 20220627123000 20220627091044 20220626200514 20220626185611
:ctime:    20220626185611
:END:
#+title: 项目相关
#+date: [2022-06-26 周日]

* 总结
** 环境搭建
1. Arduino UNO，ESP8266MOD 和 ESP-12E驱动安装
2. Arduino IDE 安装，1.8.19
3. 为三块开发板配置开发环境，Arduino 默认安装，ESP8266 在首选项开发板管理中配置，添加网址
   https://arduino.esp8266.com/stable/package_esp8266com_index.json
4. 开发具体模块时，需要模块相关的库文件，我们需要去官网下载.zip库文件，然后通过
   Arduino IDE加载.

** 模块总结
*** 串口
1. 串口波特率初始化为 115200，和Arduino IDE中串口监视器保持一致。不一致会乱码。
2. 输出提示内容、用于调试 debug
*** LED(发光二极管)
1. 注意正负极，长脚是正极，短脚是负极
2. 最好串联一个电阻（如 220Ω）
3. 用来显示信息，示警
*** 电位器/计
1. 将正负极接到电位计的两端，中间引脚接到模拟端口 A0 ~ A5 任何一个
2. 模拟值取值范围 0 ~ 1023，在计算电压时需要将电压除以1024，然后乘以模拟值
*** PWM概念
1. 占空比问题，一般数字端口只能输出0或1，但是PWM端口输出的取值范围为0~255
2. 可以是电位计去调整
*** 1位数码管
1. 注意是共阴极还是共阳极
2. 接电路时候一定要注意引脚和各段LED的对应关系
*** 4位数码管
1. 注意是共阴极还是共阳极
2. 接电路时候一定要注意引脚和各段LED的对应关系
3. 它只能在同一时间选择一个数码管，之所看起来同时亮，我们快速选择不同数码管进行显示，
   肉眼是无法识别出来。
4. 可以用来计数、计时、显示数值
*** LCD1602
1. 注意引脚接法，需要和电位计搭配使用
2. 它只能显示两行，每行16个字符，只能显示ASCII码
3. 用于显示信息
*** 按键模块
1. 其实就是个开关
2. 注意引脚，不要接短路了
*** 蜂鸣器
1. 使用有源蜂鸣器，注意引脚正负极，长正短负
2. 用来报警、播放音乐等等
*** 键盘模块
1. 键盘按键的值由我们自己定义
*** 74HC138译码器
1. 通过3个引脚达到8个选择的目的
*** 光敏电阻
1. 光照越强，电阻越小。一定要代码和电路设计一定要保持一致。
*** RGB 三基色 LED
1. 可以使用不同的颜色显示不同的信息
*** 舵机
1. 注意旋转范围180°
*** 红外遥控
1. 功能可以自定义
*** 超声波测距
*** 温湿度传感器
*** MQ-9可燃气体传感器
*** PM2.5传感器
*** WIFI
1. MCU作为服务器，创建热点，使用手机连接它的热点，访问 192.168.4.1
2. MCU作为客户端，连接2.4GHZ频段的无线网络，连接MQTT服务器Adafruit

* 课设方案
小学期实训课设可以采取多种方案。

** 方案一

1. 使用 Arduino 采集传感器数据。
2. 使用 ESP8266MOD 作为服务器，提供热点，web 服务可以显示各种数据、控制外设。
3. 使用 ESP-12E 作为客户端，连接 MQTT Server，向 Adafruit 网站发布数据，订阅消息控制外设。
4. Arduino、ESP8266MOD 和 ESP-12E 间采用软串口通信。如，ArduinoJSON.

                                                         连接Adafruit +--------+
                                                          +-----------+ MQTT   |
                                                          |   +------>| Server |
                                                          V   |       +--------+
            +---------+             +--------+         +------+---+
      PM2.5 |         |             |        |         |          |
      ----->|         |   串口      |        |  串口   |          |-----> 订阅消息
      温湿  |         +------------>|  ESP   +-------->|   ESP    |       控制外设
      ----->|         |             |  8266  |         |   12E    |
      MQ-9  | Arduino |<------------+  MOD   |<--------+          |
      ----->|         |   通信      |        |  通信   |          |-----> 发布数据
      光强  |         |             |        |         |          |
      ----->|         |             | Server |         |  Client  |
            +---------+             +--------+         +----------+
                                     /     \
                                    /       \
                                   / AP 热点 \
                                  /           \
                              +------+     +------+
                              | 控制 |     | 显示 |
                              |      |     | 环境 |
                              | 外设 |     | 数据 |
                              +------+     +------+

** 方案二

1. 使用 Arduino 采集传感器数据。
2. 使用 ESP-12E 和 ESP8266MOD 作为客户端，连接 MQTT Server，向 Adafruit 网站发布
   数据，订阅消息控制外设。
3. Arduino 和 ESP8266MOD 间采用软串口通信，ESP8266MOD 和 ESP-12E 间采用 MQTT
   Server 发布-订阅消息传递数据。

                                         发布    +--------+    订阅
                                         +------>| MQTT   |---------o
                                         |+------| Server |<-------+|
                                         ||      +--------+  发布  ||
                                         |v 订阅                   |v
            +---------+             +--------+               +----------+
      PM2.5 |         |             |        |               |          |
      ----->|         |   串口      |        |   二者通过    |          |-----> 订阅消息
      温湿  |         +------------>|  ESP   |   WIFI 传递   |   ESP    |       控制外设
      ----->|         |             |  8266  |   数据        |   12E    |
      MQ-9  | Arduino |<------------+  MOD   |               |          |
      ----->|         |   通信      |        |   发布即发送  |          |-----> 发布数据
      光强  |         |             |        |   数据，订阅  |          |
      ----->|         |             | Server |   即接收数据  |  Client  |
            +---------+             +--------+               +----------+

** 方案三

1. 使用 ESP-12E 和 ESP8266MOD 作为客户端，连接 MQTT Server，向 Adafruit 网站发布
   数据，订阅消息控制外设。
2. 使用 ESP8266MOD 采集传感器数据，将数据发布到 MQTT Server。
3. 使用 ESP-12E 订阅 ESP8266MOD 发布到 MQTT Server 的消息，获取传感器数据。控制外设。

                       发布    +--------+    订阅
                    +--------->| MQTT   |---------o
                    | +--------| Server |<-------+|
                    | | 订阅   +--------+  发布  ||
                    | v                          |v
            +-----------+                   +------------+
      PM2.5 |           |                   |            |
      ----->|           |     二者通过      |            |
      温湿  |    ESP    |     WIFI 传递     |    ESP     |
      ----->|    8266   |     数据          |    12E     |
      MQ-9  +    MOD    |                   |            |-----> 控制外设
      ----->|           |     发布即发送    |            |
      光强  |           |     数据，订阅    |            |
      ----->|   Server  |     即接收数据    |   Client   |
            +-----------+                   +------------+
